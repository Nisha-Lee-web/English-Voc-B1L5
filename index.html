<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åœ‹ä¸€è‹±èªå–®å­—åˆ†ç´šæŒ‘æˆ°</title>
    <!-- è¼‰å…¥å¿…è¦è³‡æº -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- å¼•å…¥ Lucide åœ–ç¤ºåº« -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&display=swap');
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #f8fafc;
        }
        .perspective-1000 { perspective: 1000px; }
        .backface-hidden { backface-visibility: hidden; }
        .rotate-y-180 { transform: rotateY(180deg); }
        .transform-style-3d { transform-style: preserve-3d; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const LucideIcon = ({ name, className }) => {
            return <i data-lucide={name} className={className}></i>;
        };

        // å®Œæ•´å–®å­—è³‡æ–™åº«èˆ‡åŸå§‹åœ–ç‰‡å®šç¾©
        const vocabularyList = [
            { id: 1, word: "week", pos: "(n.)", meaning: "æ˜ŸæœŸ", image: "ğŸ—“ï¸" },
            { id: 2, word: "Monday", pos: "(n.)", meaning: "æ˜ŸæœŸä¸€", image: "ğŸ“…[Mon.]" },
            { id: 3, word: "Tuesday", pos: "(n.)", meaning: "æ˜ŸæœŸäºŒ", image: "ğŸ“…[Tue.]" },
            { id: 4, word: "Wednesday", pos: "(n.)", meaning: "æ˜ŸæœŸä¸‰", image: "ğŸ“…[Wed.]" },
            { id: 5, word: "basketball", pos: "(n.)", meaning: "ç±ƒçƒ", image: "ğŸ€" },
            { id: 6, word: "Thursday", pos: "(n.)", meaning: "æ˜ŸæœŸå››", image: "ğŸ“…[Thu.]" },
            { id: 7, word: "Friday", pos: "(n.)", meaning: "æ˜ŸæœŸäº”", image: "ğŸ“…[Fri.]" },
            { id: 8, word: "Saturday", pos: "(n.)", meaning: "æ˜ŸæœŸå…­", image: "ğŸ“…[Sat.]" },
            { id: 9, word: "birthday", pos: "(n.)", meaning: "ç”Ÿæ—¥", image: "ğŸ‚" },
            { id: 10, word: "party", pos: "(n.)", meaning: "æ´¾å°", image: "ğŸ‰" },
            { id: 11, word: "Sunday", pos: "(n.)", meaning: "æ˜ŸæœŸæ—¥", image: "ğŸ“…[Sun.]" },
            { id: 12, word: "day", pos: "(n.)", meaning: "æ—¥", image: "â˜€ï¸|ğŸŒ™" },
            { id: 13, word: "weekend", pos: "(n.)", meaning: "é€±æœ«", image: "ğŸ“…[WEEKEND]" },
            { id: 14, word: "noon", pos: "(n.)", meaning: "ä¸­åˆ", image: "ğŸ•›" },
            { id: 15, word: "wake up", pos: "", meaning: "é†’ä¾†", image: "WAKEUP_SPECIAL" },
            { id: 16, word: "look for", pos: "", meaning: "å°‹æ‰¾", image: "ğŸ”" },
            { id: 17, word: "Hurry up.", pos: "", meaning: "å¿«ä¸€é»", image: "ğŸƒğŸ’¨" },
            { id: 18, word: "by the way", pos: "", meaning: "é †å¸¶ä¸€æ", image: "ğŸ’¬" },
            { id: 19, word: "join", pos: "(v.)", meaning: "åƒåŠ ; åŠ å…¥", image: "â•" },
            { id: 20, word: "group", pos: "(n.)", meaning: "åœ˜é«”", image: "ğŸ‘¥" },
            { id: 21, word: "chat", pos: "(n. ; v.)", meaning: "è«‡è©±", image: "ğŸ‘¥ğŸ’¬" }, 
            { id: 22, word: "tonight", pos: "(adv.)", meaning: "ä»Šæ™š", image: "ğŸŒƒ" },
            { id: 23, word: "meeting", pos: "(n.)", meaning: "æœƒè­°", image: "ğŸ‘¥ğŸ“ŠğŸ¤" }, 
            { id: 24, word: "p.m.", pos: "(adv.)", meaning: "ä¸‹åˆ; æ™šä¸Š", image: "ğŸŒ™" },
            { id: 25, word: "life", pos: "(n.)", meaning: "ç”Ÿæ´»", image: "LIFE_SPECIAL" },
            { id: 26, word: "prepare", pos: "(v.)", meaning: "æº–å‚™", image: "ğŸ‘©â€ğŸ³ğŸ¥˜ğŸ½ï¸" },
            { id: 27, word: "oâ€™clock", pos: "(adv.)", meaning: "â€¦â€¦é»é˜", image: "oclock_5.png" },
            { id: 28, word: "everyone (everybody)", pos: "(pron.)", meaning: "æ¯å€‹äºº; å„ä½", image: "ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦" },
            { id: 29, word: "a.m.", pos: "(adv.)", meaning: "ä¸Šåˆ; å‡Œæ™¨", image: "ğŸŒ…" },
            { id: 30, word: "city", pos: "(n.)", meaning: "åŸå¸‚", image: "ğŸ™ï¸" },
            { id: 31, word: "say", pos: "(v.)", meaning: "èªª", image: "ğŸ—£ï¸ğŸ’¬" }, 
            { id: 32, word: "sun", pos: "(n.)", meaning: "å¤ªé™½", image: "â˜€ï¸" },
            { id: 33, word: "rise", pos: "(v.)", meaning: "ä¸Šå‡", image: "â¤´ï¸" },
            { id: 34, word: "shine", pos: "(v.)", meaning: "ç…§è€€; ç™¼å…‰", image: "âœ¨" },
            { id: 35, word: "dinner", pos: "(n.)", meaning: "æ™šé¤", image: "ğŸ½ï¸ğŸ•—" } 
        ];

        const speak = (text) => {
            if ('speechSynthesis' in window) {
                window.speechSynthesis.cancel();
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'en-US';
                utterance.rate = 0.8; 
                window.speechSynthesis.speak(utterance);
            }
        };

        const shuffleArray = (array) => {
            return [...array].sort(() => Math.random() - 0.5);
        };

        function App() {
            const [mode, setMode] = useState('menu'); 
            const [difficulty, setDifficulty] = useState('easy'); 
            const [quizQuestions, setQuizQuestions] = useState([]);
            const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0);
            const [score, setScore] = useState(0);
            const [selectedAnswer, setSelectedAnswer] = useState(null);
            const [userInput, setUserInput] = useState(""); 
            const [showFeedback, setShowFeedback] = useState(false);
            const [studyIndex, setStudyIndex] = useState(0);
            const [isFlipped, setIsFlipped] = useState(false);

            useEffect(() => {
                if (window.lucide) window.lucide.createIcons();
            }, [mode, studyIndex, currentQuestionIndex, isFlipped, showFeedback]);

            const startQuiz = (level) => {
                setDifficulty(level);
                const shuffledVocab = shuffleArray(vocabularyList).slice(0, 10);
                const questions = shuffledVocab.map(item => {
                    const distractors = shuffleArray(vocabularyList.filter(v => v.id !== item.id)).slice(0, 3);
                    return { target: item, options: shuffleArray([item, ...distractors]) };
                });
                setQuizQuestions(questions);
                setCurrentQuestionIndex(0);
                setScore(0);
                setSelectedAnswer(null);
                setUserInput("");
                setShowFeedback(false);
                setMode('quiz');
                if (level === 'medium') setTimeout(() => speak(questions[0].target.word), 500);
            };

            const handleChoiceAnswer = (option) => {
                if (showFeedback) return;
                const currentQ = quizQuestions[currentQuestionIndex];
                setSelectedAnswer(option);
                setShowFeedback(true);
                if (option.id === currentQ.target.id) setScore(s => s + 10);
                speak(currentQ.target.word);
                setTimeout(nextQuestion, 2000);
            };

            const handleSpellingSubmit = (e) => {
                e.preventDefault();
                if (showFeedback || !userInput.trim()) return;
                const currentQ = quizQuestions[currentQuestionIndex];
                const isCorrect = userInput.trim().toLowerCase() === currentQ.target.word.toLowerCase();
                setShowFeedback(true);
                if (isCorrect) setScore(s => s + 10);
                speak(currentQ.target.word);
                setTimeout(nextQuestion, 2000);
            };

            const nextQuestion = () => {
                if (currentQuestionIndex < 9) {
                    const nextIdx = currentQuestionIndex + 1;
                    setCurrentQuestionIndex(nextIdx);
                    setSelectedAnswer(null);
                    setUserInput("");
                    setShowFeedback(false);
                    if (difficulty === 'medium') speak(quizQuestions[nextIdx].target.word);
                } else {
                    setMode('result');
                }
            };

            // åŸå§‹ç‰ˆæœ¬æœ€ç²¾ç·»çš„åœ–å½¢æ¸²æŸ“å‡½æ•¸
            const renderVisualImage = (imageText) => {
                if (imageText === "LIFE_SPECIAL") {
                    return (
                        <div className="flex flex-col items-center mb-6 space-y-2">
                            <div className="flex items-center space-x-4 bg-slate-50 p-4 rounded-2xl border-2 border-dashed border-slate-200">
                                <span className="text-6xl">ğŸš¶</span>
                                <span className="text-6xl">ğŸ’¼</span>
                                <div className="flex items-center bg-white p-2 rounded-xl shadow-sm border border-slate-100">
                                   <span className="text-6xl">ğŸ‘¦</span>
                                   <span className="text-5xl">ğŸ’</span>
                                </div>
                            </div>
                        </div>
                    );
                }

                if (imageText === "WAKEUP_SPECIAL") {
                    return (
                        <div className="relative w-48 h-32 flex items-center justify-center mb-6">
                            <div className="text-7xl z-10">ğŸ›ŒğŸ••</div>
                            <div className="absolute -top-2 -right-2 text-5xl animate-bounce">â˜€ï¸</div>
                        </div>
                    );
                }

                if (imageText.startsWith("ğŸ“…[")) {
                    const content = imageText.match(/\[(.*?)\]/)?.[1] || "";
                    const days = ["Mon.", "Tue.", "Wed.", "Thu.", "Fri.", "Sat.", "Sun."];
                    const isWeekendMode = content === "WEEKEND";
                    
                    return (
                        <div className="flex flex-col items-center mb-6">
                            <div className="bg-white border-2 border-slate-200 rounded-xl p-4 shadow-md w-64 mx-auto">
                                <div className="bg-indigo-600 text-white text-[10px] font-bold py-1 px-2 rounded mb-3 text-center uppercase">
                                    {isWeekendMode ? "Weekend Study" : "Calendar"}
                                </div>
                                <div className="grid grid-cols-7 gap-1">
                                    {days.map(d => {
                                        const isSelected = content === d;
                                        const isSatOrSun = d === "Sat." || d === "Sun.";
                                        let className = "flex flex-col items-center p-1 rounded text-[9px] ";
                                        if (isWeekendMode && isSatOrSun) className += "border-2 border-amber-500 bg-amber-50 font-bold text-amber-700 scale-110 z-10";
                                        else if (isSelected) className += "bg-indigo-600 text-white font-bold";
                                        else className += "text-slate-400 opacity-60";
                                        return (
                                            <div key={d} className={className}>
                                                <span>{d}</span>
                                                {(isSelected || (isWeekendMode && isSatOrSun)) && <div className="w-1 h-1 bg-current rounded-full mt-0.5"></div>}
                                            </div>
                                        );
                                    })}
                                </div>
                            </div>
                        </div>
                    );
                }
                return <div className="text-7xl mb-6">{imageText}</div>;
            };

            if (mode === 'menu') return (
                <div className="flex flex-col items-center justify-center min-h-screen p-4">
                    <div className="bg-white p-8 rounded-3xl shadow-xl max-w-2xl w-full border-t-8 border-indigo-600 text-center">
                        <div className="flex justify-center mb-4"><div className="bg-indigo-100 p-4 rounded-full"><LucideIcon name="brain" className="w-12 h-12 text-indigo-600" /></div></div>
                        <h1 className="text-3xl font-black text-slate-800 mb-2">åœ‹ä¸€è‹±èªå–®å­—æŒ‘æˆ°</h1>
                        <p className="text-slate-500 mb-8 italic">è¦–è¦ºè¨˜æ†¶æ³•ï¼šçœ‹åœ–ç‰‡ã€å­¸å–®å­—</p>
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <button onClick={() => { setMode('study'); setStudyIndex(0); setIsFlipped(false); }} className="md:col-span-2 bg-emerald-50 text-emerald-700 border-2 border-emerald-200 p-4 rounded-2xl flex items-center justify-center font-bold hover:bg-emerald-100 transition">
                                <LucideIcon name="book-open" className="mr-2" /> æ¨¡å¼ 0ï¼šå–®å­—é ç¿’å¡
                            </button>
                            <button onClick={() => startQuiz('easy')} className="bg-blue-50 text-blue-700 border-2 border-blue-200 p-6 rounded-2xl flex flex-col items-center hover:bg-blue-100 transition">
                                <LucideIcon name="image" className="mb-2 w-8 h-8" />
                                <span className="font-bold">çœ‹åœ–é¸ç¾©</span>
                            </button>
                            <button onClick={() => startQuiz('medium')} className="bg-purple-50 text-purple-700 border-2 border-purple-200 p-6 rounded-2xl flex flex-col items-center hover:bg-purple-100 transition">
                                <LucideIcon name="headphones" className="mb-2 w-8 h-8" />
                                <span className="font-bold">è½éŸ³é¸å­—</span>
                            </button>
                            <button onClick={() => startQuiz('hard')} className="md:col-span-2 bg-rose-50 text-rose-700 border-2 border-rose-200 p-6 rounded-2xl flex flex-col items-center hover:bg-rose-100 transition">
                                <LucideIcon name="keyboard" className="mb-2 w-8 h-8" />
                                <span className="font-bold">æ‹¼å­—æŒ‘æˆ°</span>
                            </button>
                        </div>
                    </div>
                </div>
            );

            if (mode === 'study') {
                const word = vocabularyList[studyIndex];
                return (
                    <div className="flex flex-col items-center justify-center min-h-screen p-4">
                        <div className="w-full max-w-md flex justify-between mb-4">
                            <button onClick={() => setMode('menu')} className="text-slate-500 font-bold flex items-center"><LucideIcon name="chevron-left" className="mr-1" /> è¿”å›é¸å–®</button>
                            <span className="text-slate-500 font-bold">{studyIndex + 1} / {vocabularyList.length}</span>
                        </div>
                        <div className="perspective-1000 w-full max-w-md h-[400px] cursor-pointer" onClick={() => setIsFlipped(!isFlipped)}>
                            <div className={`relative w-full h-full transition-transform duration-500 transform-style-3d ${isFlipped ? 'rotate-y-180' : ''}`}>
                                <div className="absolute w-full h-full bg-white rounded-3xl shadow-xl border-b-8 border-indigo-500 backface-hidden flex flex-col items-center justify-center p-8 text-center" style={{backfaceVisibility: 'hidden'}}>
                                    {renderVisualImage(word.image)}
                                    <h2 className="text-4xl font-black text-slate-800 tracking-tight">{word.word}</h2>
                                    {word.pos && <span className="mt-2 px-3 py-1 bg-indigo-100 text-indigo-600 rounded-lg font-bold text-sm italic">{word.pos}</span>}
                                    <button onClick={(e) => { e.stopPropagation(); speak(word.word); }} className="mt-6 p-4 bg-indigo-50 rounded-full text-indigo-600"><LucideIcon name="volume-2" /></button>
                                </div>
                                <div className="absolute w-full h-full bg-indigo-600 rounded-3xl shadow-xl border-b-8 border-indigo-800 backface-hidden flex flex-col items-center justify-center p-8 text-white text-center" style={{backfaceVisibility: 'hidden', transform: 'rotateY(180deg)'}}>
                                    <h2 className="text-5xl font-black">{word.meaning}</h2>
                                    <p className="mt-4 text-indigo-200">é»æ“Šå¡ç‰‡ç¿»å›æ­£é¢</p>
                                </div>
                            </div>
                        </div>
                        <div className="flex gap-4 mt-8 w-full max-w-md">
                            <button onClick={() => { setIsFlipped(false); setStudyIndex(i => (i-1+vocabularyList.length)%vocabularyList.length); }} className="flex-1 bg-white p-5 rounded-2xl font-bold shadow-md hover:bg-slate-50">ä¸Šä¸€å€‹</button>
                            <button onClick={() => { setIsFlipped(false); setStudyIndex(i => (i+1)%vocabularyList.length); }} className="flex-1 bg-indigo-600 text-white p-5 rounded-2xl font-bold shadow-lg hover:bg-indigo-700">ä¸‹ä¸€å€‹</button>
                        </div>
                    </div>
                );
            }

            if (mode === 'quiz') {
                const q = quizQuestions[currentQuestionIndex];
                if (!q) return null;
                return (
                    <div className="flex flex-col items-center min-h-screen p-4">
                        <div className="w-full max-w-2xl mt-8">
                            <div className="flex justify-between font-bold text-slate-500 mb-2"><span>é¡Œç›® {currentQuestionIndex + 1} / 10</span><span className="text-indigo-600">å¾—åˆ†: {score}</span></div>
                            <div className="h-2 w-full bg-slate-200 rounded-full overflow-hidden shadow-inner"><div className="h-full bg-indigo-500 transition-all duration-700" style={{ width: `${(currentQuestionIndex + 1) * 10}%` }}></div></div>
                        </div>
                        <div className="bg-white w-full max-w-2xl mt-8 p-10 rounded-3xl shadow-lg text-center border border-slate-100">
                            {difficulty === 'easy' && <>{renderVisualImage(q.target.image)}<h2 className="text-4xl font-black text-slate-800 mb-6">{q.target.word}</h2></>}
                            {difficulty === 'medium' && <div className="py-12"><button onClick={() => speak(q.target.word)} className="bg-purple-100 p-8 rounded-full text-purple-600 mb-6 hover:scale-110 transition shadow-lg"><LucideIcon name="volume-2" className="w-12 h-12" /></button><p className="text-slate-400 font-bold">é»æ“Šæ’­æ”¾è²éŸ³</p></div>}
                            {difficulty === 'hard' && <>{renderVisualImage(q.target.image)}<h2 className="text-3xl font-black text-slate-800 mb-8">{q.target.meaning}</h2></>}

                            {difficulty !== 'hard' ? (
                                <div className="grid grid-cols-1 sm:grid-cols-2 gap-4">
                                    {q.options.map((opt) => (
                                        <button key={opt.id} disabled={showFeedback} onClick={() => handleChoiceAnswer(opt)} className={`p-5 rounded-2xl border-2 font-bold text-xl transition-all duration-300 ${showFeedback ? (opt.id === q.target.id ? "bg-emerald-500 text-white border-emerald-500 scale-105" : (selectedAnswer?.id === opt.id ? "bg-rose-500 text-white border-rose-500" : "opacity-30 grayscale")) : "border-slate-100 hover:border-indigo-500 hover:bg-indigo-50"}`}>
                                            {difficulty === 'easy' ? opt.meaning : opt.word}
                                        </button>
                                    ))}
                                </div>
                            ) : (
                                <form onSubmit={handleSpellingSubmit}>
                                    <input autoFocus value={userInput} onChange={e => setUserInput(e.target.value)} disabled={showFeedback} className={`w-full p-5 text-center text-3xl font-black rounded-2xl border-4 transition-all ${showFeedback ? (userInput.trim().toLowerCase() === q.target.word.toLowerCase() ? "border-emerald-500 bg-emerald-50 text-emerald-700" : "border-rose-500 bg-rose-50 text-rose-700") : "border-slate-100 focus:border-indigo-500 outline-none"}`} placeholder="åœ¨æ­¤è¼¸å…¥å–®å­—..." />
                                    {showFeedback && <div className="mt-4 text-2xl font-bold text-emerald-600 animate-bounce">æ­£ç¢ºç­”æ¡ˆ: {q.target.word}</div>}
                                    {!showFeedback && <button type="submit" className="mt-6 w-full bg-indigo-600 text-white p-5 rounded-2xl font-black text-xl shadow-lg hover:bg-indigo-700">ç¢ºèªç­”æ¡ˆ</button>}
                                </form>
                            )}
                        </div>
                    </div>
                );
            }

            if (mode === 'result') return (
                <div className="flex flex-col items-center justify-center min-h-screen p-4">
                    <div className="bg-white p-12 rounded-3xl shadow-xl max-w-md w-full text-center border-b-8 border-indigo-600">
                        <div className="text-7xl mb-4">{score >= 80 ? "ğŸ‘‘" : score >= 60 ? "ğŸ‰" : "ğŸ’ª"}</div>
                        <h2 className="text-3xl font-black text-slate-800">æŒ‘æˆ°å®Œæˆï¼</h2>
                        <div className="text-8xl font-black text-indigo-600 my-8">{score}</div>
                        <div className="grid grid-cols-1 gap-4">
                            <button onClick={() => setMode('menu')} className="bg-indigo-600 text-white p-5 rounded-2xl font-bold shadow-lg hover:bg-indigo-700 transition">å›åˆ°ä¸»é¸å–®</button>
                            <button onClick={() => startQuiz(difficulty)} className="bg-slate-100 text-slate-600 p-4 rounded-2xl font-bold hover:bg-slate-200 transition">å†æŒ‘æˆ°ä¸€æ¬¡</button>
                        </div>
                    </div>
                </div>
            );
            return null;
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>

